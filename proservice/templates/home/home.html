{% load static %}
<section
  x-data="heroSlider()"
  x-init="init()"
  @mouseenter="autoplay = false"
  @mouseleave="autoplay = true"
  class="relative w-full h-[85vh] overflow-hidden bg-slate-900"
>
  <template x-for="(slide, index) in slides" :key="'slide-' + index">
    <div
      x-show="currentSlide === index"
      x-transition:enter="transition ease-out duration-1000"
      x-transition:enter-start="opacity-0 scale-105"
      x-transition:enter-end="opacity-100 scale-100"
      x-transition:leave="transition ease-in duration-500"
      x-transition:leave-start="opacity-100"
      x-transition:leave-end="opacity-0"
      class="absolute inset-0"
    >
      <img
        :src="slide.image"
        class="absolute inset-0 w-full h-full object-cover"
        :class="currentSlide === index ? 'animate-slow-zoom' : ''"
      />

      <div
        class="absolute inset-0 bg-gradient-to-r from-slate-900 via-slate-900/40 to-transparent"
      ></div>

      <div class="relative z-10 h-full flex items-center px-10 md:px-24">
        <div class="max-w-3xl">
          <span
            class="inline-block text-yellow-500 font-bold text-sm uppercase tracking-[0.3em] mb-4 overflow-hidden"
          >
            <span
              class="block transform transition-transform duration-700 delay-300"
              :class="currentSlide === index ? 'translate-y-0' : 'translate-y-full'"
            >
              Proservice Ingeniería
            </span>
          </span>

          <h1
            class="text-5xl md:text-7xl font-black text-white mb-6 leading-tight"
            x-text="slide.title"
          ></h1>

          <p
            class="text-xl text-slate-200 mb-10 max-w-xl leading-relaxed font-light"
            x-text="slide.description"
          ></p>

          <div class="flex flex-wrap gap-4">
            <button
              @click="$dispatch('abrir-proyecto', slide.title)"
              class="bg-yellow-500 hover:bg-white text-slate-900 px-10 py-4 rounded-2xl font-black text-xs uppercase tracking-widest transition-all duration-300 shadow-2xl flex items-center gap-3"
            >
              <span x-text="slide.buttonText"></span>
              <i class="fas fa-plus text-[10px]"></i>
            </button>
          </div>
        </div>
      </div>
    </div>
  </template>

  <div
    class="absolute bottom-12 left-10 md:left-24 z-20 flex items-center gap-8"
  >
    <div class="flex gap-3">
      <template x-for="(slide, index) in slides" :key="'dot-' + index">
        <button
          @click="goTo(index)"
          class="h-1 transition-all duration-500 rounded-full"
          :class="currentSlide === index ? 'w-12 bg-yellow-500' : 'w-4 bg-white/30'"
        ></button>
      </template>
    </div>
  </div>

  <div class="absolute bottom-12 right-10 md:right-24 z-20 flex gap-4">
    <button
      @click="prev()"
      class="w-14 h-14 rounded-2xl border border-white/20 flex items-center justify-center text-white hover:bg-white hover:text-slate-900 transition-all"
    >
      <i class="fas fa-arrow-left"></i>
    </button>
    <button
      @click="next()"
      class="w-14 h-14 rounded-2xl bg-white/10 backdrop-blur-md border border-white/20 flex items-center justify-center text-white hover:bg-yellow-500 hover:text-slate-900 transition-all"
    >
      <i class="fas fa-arrow-right"></i>
    </button>
  </div>
</section>

<style>
  @keyframes slow-zoom {
    from {
      transform: scale(1);
    }
    to {
      transform: scale(1.1);
    }
  }
  .animate-slow-zoom {
    animation: slow-zoom 10s linear infinite alternate;
  }
</style>

<script>
  function heroSlider() {
    return {
      currentSlide: 0,
      autoplay: true,
      slideDuration: 6000,
      autoplayIntervalId: null,
      slides: [
        {
          title: "Iluminación Exterior LED",
          description:
            "Montajes de baja tensión, tableros de transferencia y proyectos de iluminación industrial bajo estricta normativa RIC.",
          buttonText: "Ver Proyectos",
          buttonUrl: "#portfolio",
          image: "{% static 'img/electric1.jpg' %}",
        },
        {
          title: "Climatización de Plantas",
          description:
            "Especialistas en sistemas HVAC, Chillers y mantenimiento preventivo para asegurar la continuidad operacional.",
          buttonText: "Explorar Servicios",
          buttonUrl: "#services",
          image: "{% static 'img/aire.jpeg' %}",
        },
        {
          title: "Fundaciones de Hormigón",
          description:
            "Fabricación de fundaciones piramidales para postes de 15 metros y estructuras de hormigón de alta resistencia.",
          buttonText: "Explorar Obras",
          buttonUrl: "#portfolio",
          image:
            "{% static 'img/obras/WhatsApp Image 2026-01-06 at 22.21.22.jpeg' %}",
        },
      ],
      init() {
        this.resetInterval();
      },
      resetInterval() {
        if (this.autoplayIntervalId) clearInterval(this.autoplayIntervalId);
        this.autoplayIntervalId = setInterval(() => {
          if (this.autoplay) this.next();
        }, this.slideDuration);
      },
      next() {
        this.currentSlide = (this.currentSlide + 1) % this.slides.length;
        this.resetInterval();
      },
      prev() {
        this.currentSlide =
          (this.currentSlide - 1 + this.slides.length) % this.slides.length;
        this.resetInterval();
      },
      goTo(i) {
        this.currentSlide = i;
        this.resetInterval();
      },
    };
  }
</script>
