{% load static %}
<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Proservice | Portafolio Ejecutivo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script
      defer
      src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"
    ></script>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />
    <style>
      [x-cloak] {
        display: none !important;
      }
      .custom-scrollbar::-webkit-scrollbar {
        width: 6px;
      }
      .custom-scrollbar::-webkit-scrollbar-track {
        background: #f1f5f9;
      }
      .custom-scrollbar::-webkit-scrollbar-thumb {
        background: #eab308;
        border-radius: 10px;
      }
      html {
        scroll-behavior: smooth;
      }
    </style>
  </head>

  <body
    class="bg-white text-slate-800 font-sans antialiased"
    x-data="portfolioHandler()"
    @abrir-proyecto.window="
    console.log('Mensaje recibido para:', $event.detail);
    let encontrado = projects.find(p => p.title.trim() === $event.detail.trim());
    if(encontrado) {
       openModal(encontrado);
       // Esto hace que la pantalla baje suavemente al portafolio
       document.getElementById('portfolio').scrollIntoView({behavior: 'smooth'});
    } else {
       console.log('No se encontró un proyecto con ese título exacto');
    }
  "
  >
    <section id="portflio" class="pb-32 px-6">
      <header class="pt-32 pb-20 px-6 text-center">
        <div class="max-w-3xl mx-auto">
          <span
            class="text-yellow-600 font-bold text-xs uppercase tracking-[0.4em] mb-4 block"
            >Excelencia en Ingeniería</span
          >
          <h2
            class="text-5xl md:text-6xl font-black text-slate-900 tracking-tighter mb-6"
          >
            Proyectos Destacados
          </h2>
          <div class="w-20 h-1 bg-yellow-500 mx-auto mb-8"></div>
          <p
            class="text-slate-500 text-lg md:text-xl leading-relaxed font-light"
          >
            Una selección de nuestras intervenciones más complejas en
            infraestructura eléctrica, iluminación y obras civiles industriales.
          </p>
        </div>
      </header>

      <section class="pb-32 px-6">
        <div class="max-w-5xl mx-auto space-y-32">
          <template x-for="(project, index) in projects" :key="index">
            <article
              class="group relative grid md:grid-cols-12 gap-8 items-center"
              x-transition:enter="transition ease-out duration-1000"
              x-transition:enter-start="opacity-0 translate-y-10"
              x-transition:enter-end="opacity-100 translate-y-0"
            >
              <div
                class="md:col-span-7 overflow-hidden rounded-[2.5rem] shadow-2xl bg-slate-100 aspect-video md:aspect-square lg:aspect-video relative"
              >
                <img
                  :src="project.mainImg"
                  class="w-full h-full object-cover transition duration-1000 group-hover:scale-110"
                />
                <div
                  class="absolute inset-0 bg-black/10 group-hover:bg-transparent transition-colors duration-500"
                ></div>
              </div>

              <div
                class="md:col-span-5 flex flex-col items-start space-y-6"
                :class="index % 2 === 0 ? 'md:pl-10' : 'md:pr-10 md:order-first md:items-end md:text-right'"
              >
                <span
                  class="text-yellow-600 font-bold text-[10px] uppercase tracking-widest bg-yellow-50 px-3 py-1 rounded-full"
                  x-text="project.category"
                ></span>

                <h3
                  class="text-3xl md:text-4xl font-black text-slate-900 leading-tight"
                  x-text="project.title"
                ></h3>

                <p
                  class="text-slate-500 text-lg leading-relaxed"
                  x-text="project.shortDesc"
                ></p>

                <button
                  @click="openModal(project)"
                  class="inline-flex items-center gap-3 bg-slate-900 text-white px-8 py-4 rounded-2xl font-bold text-xs uppercase tracking-widest hover:bg-yellow-500 hover:text-black transition-all duration-300 shadow-xl"
                >
                  Explorar detalles
                  <i class="fas fa-plus text-[10px]"></i>
                </button>
              </div>
            </article>
          </template>
        </div>
      </section>

      <div
        x-show="isOpen"
        class="fixed inset-0 z-[100] flex items-center justify-center p-4 md:p-8 bg-slate-900/95 backdrop-blur-md"
        x-cloak
        @keydown.escape.window="closeModal()"
        x-transition:enter="transition ease-out duration-300"
        x-transition:enter-start="opacity-0 scale-95"
        x-transition:enter-end="opacity-100 scale-100"
      >
        <div
          @click.away="closeModal()"
          class="bg-white w-full max-w-6xl h-full max-h-[90vh] rounded-[3rem] overflow-hidden flex flex-col md:flex-row relative shadow-2xl"
        >
          <button
            @click="closeModal()"
            class="absolute top-8 right-8 z-[120] bg-white/80 backdrop-blur w-12 h-12 rounded-full shadow-lg flex items-center justify-center hover:bg-yellow-500 transition-colors"
          >
            <i class="fas fa-times text-slate-800"></i>
          </button>

          <div
            class="w-full md:w-3/5 bg-slate-50 flex flex-col h-1/2 md:h-full"
          >
            <div
              class="flex-1 flex items-center justify-center p-8 overflow-hidden"
            >
              <img
                :src="activeDetailImg"
                class="max-w-full max-h-full object-contain rounded-3xl shadow-2xl"
              />
            </div>
            <div
              class="p-6 bg-white border-t border-slate-100 flex gap-4 overflow-x-auto custom-scrollbar justify-center"
            >
              <template x-for="img in currentProject.gallery" :key="img">
                <img
                  :src="img"
                  @click="activeDetailImg = img"
                  class="h-16 w-20 md:h-20 md:w-24 object-cover rounded-2xl cursor-pointer border-2 transition-all hover:scale-105"
                  :class="activeDetailImg === img ? 'border-yellow-500 ring-4 ring-yellow-500/10' : 'border-transparent opacity-40 hover:opacity-100'"
                />
              </template>
            </div>
          </div>

          <div
            class="w-full md:w-2/5 p-10 md:p-16 overflow-y-auto flex flex-col bg-white"
          >
            <div class="mb-12">
              <span
                class="text-yellow-600 font-bold text-xs uppercase tracking-widest mb-2 block"
                x-text="currentProject.category"
              ></span>
              <h2
                class="text-4xl font-black text-slate-900 leading-tight mb-6"
                x-text="currentProject.title"
              ></h2>
              <p
                class="text-slate-500 leading-relaxed text-lg"
                x-text="currentProject.fullDesc"
              ></p>
            </div>

            <div class="space-y-4 mb-12">
              <h4
                class="text-[10px] font-black uppercase tracking-[0.2em] text-slate-400"
              >
                Especificaciones Técnicas
              </h4>
              <div class="grid grid-cols-1 gap-3">
                <template x-for="spec in currentProject.specs" :key="spec">
                  <div
                    class="flex items-center gap-4 bg-slate-50 p-4 rounded-2xl border border-slate-100"
                  >
                    <i class="fas fa-check-circle text-yellow-500 text-sm"></i>
                    <span
                      class="text-sm font-bold text-slate-700"
                      x-text="spec"
                    ></span>
                  </div>
                </template>
              </div>
            </div>

            <div
              class="mt-auto pt-8 border-t border-slate-100 flex items-center justify-between"
            >
              <div>
                <span
                  class="block text-[10px] text-slate-400 uppercase font-black tracking-widest mb-1"
                  >Ubicación / Sector</span
                >
                <span
                  class="text-slate-900 font-bold"
                  x-text="currentProject.serviceScope"
                ></span>
              </div>
              <i class="fas fa-hard-hat text-3xl text-slate-100"></i>
            </div>
          </div>
        </div>
      </div>
    </section>
    <script>
      function portfolioHandler() {
        return {
          isOpen: false,
          currentProject: {},
          activeDetailImg: "",
          projects: [
            {
              title: "Iluminación Exterior LED",
              category: "Iluminación Industrial",
              shortDesc:
                "Implementación de sistemas inteligentes para espacios públicos de gran escala.",
              fullDesc:
                "Modernización integral de parque lumínico. Instalamos equipos con tecnología de última generación IP66, logrando una eficiencia del 60% y cumpliendo con la normativa DS43.",
              serviceScope: "Santiago Centro",
              mainImg: "{% static 'img/plaza/IMG-20251204-WA0078.jpg' %}",
              gallery: [
                "{% static 'img/plaza/IMG-20251204-WA0117.jpg' %}",
                "{% static 'img/plaza/IMG-20251204-WA0078.jpg' %}",
                "{% static 'img/plaza/IMG-20251204-WA0049.jpg' %}",
                "{% static 'img/plaza/IMG-20251204-WA0059.jpg' %}",
                "{% static 'img/plaza/IMG-20251204-WA0079.jpg' %}",
                "{% static 'img/plaza/IMG-20251204-WA0044.jpg' %}",
                "{% static 'img/plaza/IMG-20251204-WA0083.jpg' %}",
                "{% static 'img/plaza/IMG-20251204-WA0086.jpg' %}",
                "{% static 'img/plaza/IMG-20251204-WA0087.jpg' %}",
                "{% static 'img/plaza/IMG-20251204-WA0081.jpg' %}",
                "{% static 'img/plaza/IMG-20251204-WA0064.jpg' %}",
                "{% static 'img/plaza/IMG-20251204-WA0025.jpg' %}",
              ],
              specs: [
                "Equipos LED de Alta Gama",
                "Control Telemático",
                "Canalización Subterránea",
                "Certificación SEC",
              ],
            },
            {
              title: "Climatización de Plantas",
              category: "Mantenimiento Crítico",
              shortDesc:
                "Optimización de temperatura para centros de datos y logística pesada.",
              fullDesc:
                "Ejecución de mantenimiento mayor en equipos Chiller y Fan Coil. Se realizó limpieza química de precisión y balanceo de consumos para asegurar la continuidad operativa.",
              serviceScope: "Sector Norte / Industrial",
              mainImg: "{% static 'img/aire/IMG-20250901-WA0057.jpg' %}",
              gallery: [
                "{% static 'img/aire/IMG-20250901-WA0057.jpg' %}",
                "{% static 'img/aire/IMG-20250901-WA0060.jpg' %}",
                "{% static 'img/aire/IMG-20250901-WA0062.jpg' %}",
                "{% static 'img/aire/IMG-20250901-WA0064.jpg' %}",
                "{% static 'img/aire/IMG-20250901-WA0065.jpg' %}",
                "{% static 'img/aire/IMG-20250901-WA0066.jpg' %}",
                "{% static 'img/aire/IMG-20250901-WA0067.jpg' %}",
                "{% static 'img/aire/IMG-20250901-WA0068.jpg' %}",
              ],
              specs: [
                "Lavado de Serpentines",
                "Análisis Termográfico",
                "Carga Certificada",
                "Optimización de Energía",
              ],
            },
            {
              title: "Fundaciones de Hormigón",
              category: "Obras Civiles",
              shortDesc:
                "Estructuras piramidales de alta resistencia para soporte de postes de 15 metros.",
              fullDesc:
                "Diseño y ejecución de fundaciones piramidales a base de hormigón armado, específicamente calculadas para el anclaje de postes de 15 metros. Estas estructuras aseguran la estabilidad mecánica y la resistencia ante cargas de viento y peso propio en proyectos de infraestructura masiva.",
              serviceScope: "Infraestructura Vial / Logística",
              mainImg: "{% static 'img/obras/WhatsApp_22_21_24.jpeg' %}",
              gallery: [
                "{% static 'img/obras/WhatsApp_22_21_20.jpeg' %}",
                "{% static 'img/obras/WhatsApp_22_21_21.jpeg' %}",
                "{% static 'img/obras/WhatsApp_22_21_22.jpeg' %}",
                "{% static 'img/obras/WhatsApp_22_21_23.jpeg' %}",
                "{% static 'img/obras/WhatsApp_22_21_24.jpeg' %}",
                "{% static 'img/obras/WhatsApp_22_21_25.jpeg' %}",
                "{% static 'img/obras/WhatsApp_22_21_26.jpeg' %}",
                "{% static 'img/obras/WhatsApp_22_21_27.jpeg' %}",
                "{% static 'img/obras/WhatsApp_22_21_28.jpeg' %}",
                "{% static 'img/obras/WhatsApp_22_21_29.jpeg' %}",
                "{% static 'img/obras/WhatsApp_22_21_31.jpeg' %}",
                "{% static 'img/obras/WhatsApp_22_21_32.jpeg' %}",
                "{% static 'img/obras/WhatsApp_22_21_33.jpeg' %}",
              ],
              specs: [
                "Hormigón H30 de Alta Resistencia",
                "Geometría Piramidal Optimizada",
                "Soporte para Postes de 15m",
                "Resistencia a Cargas de Viento",
              ],
            },
          ],
          openModal(project) {
            this.currentProject = project;
            this.activeDetailImg = project.mainImg;
            this.isOpen = true;
            document.body.style.overflow = "hidden";
          },
          closeModal() {
            this.isOpen = false;
            document.body.style.overflow = "auto";
          },
        };
      }
    </script>
  </body>
</html>
